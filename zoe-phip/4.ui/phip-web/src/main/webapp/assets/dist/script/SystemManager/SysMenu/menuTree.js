define("modules/SystemManager/SysMenu/menuTree",["./req"],function(a,b,c){var d={req:a("./req").req,treeObj:null,init:function(){d.buildTree(),d.onSave()},setting:{data:{keep:{parent:!0},key:{name:"name"},simpleData:{enable:!0,idKey:"id",name:"name",pIdKey:"fkParentMenuId",rootPId:"root"}},edit:{drag:{autoExpandTrigger:!0},enable:!0,showRemoveBtn:!1,showRenameBtn:!1},callback:{beforeDrag:function(){var a=1!=common.getParamFromUrl("noDrag");return a},onClick:function(a,b,c){var d=1!=common.getParamFromUrl("noDrag");if(!d){var e=common.getTopWindowDom();$.isFunction(e.win_menu_tree_select_callback)&&e.win_menu_tree_select_callback(c)}}}},buildTree:function(){d.req.getList(null,function(a){var b=$.merge([{id:0,name:"菜单根节点",fkParentMenuId:"root"}],a.result.rows),c=$.fn.zTree.init($("#tree"),d.setting,b);c.expandAll(!0)})},onSave:function(){var a=common.getTopWindowDom();a.win_menu_tree_callback=function(a){var b=$.fn.zTree.getZTreeObj("tree"),c=b.getNodes(),e=b.transformToArray(c);e.splice(0,1),d.req.updateList({list:JSON.stringify(e)},function(b){if(b.isSuccess){var c=common.getTopWindowDom();a(),c.win_menu_tree_dialog.close()}})}}};b.init=function(){d.init()}});