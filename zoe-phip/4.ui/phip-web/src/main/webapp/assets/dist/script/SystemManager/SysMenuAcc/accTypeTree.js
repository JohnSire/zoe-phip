define("modules/SystemManager/SysMenuAcc/accTypeTree",["./buildMenuAccGrid","./buildUserGrid","./req"],function(a,b,c){var d=common.getTopWindowDom(),e=null,f={dictCatalogGrid:null,dictItemGrid:null,grid:a("./buildMenuAccGrid"),userGrid:a("./buildUserGrid"),req:a("./req").req,catalogCode:"MENU_ACC_TYPE",catalogId:"",init:function(){g.init(),f.event(),f.grid.init(),f.userGrid.init()},event:function(){$("#addUser").click(function(){seajs.use("{dir}/BaseList/tools.js",function(a){d.list_user_storage=f.req.getCurrentUserList(f.catalogId,""),a.user({height:500,width:540,callback:function(a){var b=[];if(a)for(var c=0;c<a.length;c++)b.push(a[c].Id);var d=new Request("/user/addUserAcc");d.post({data:{catalogId:f.catalogId,ids:b.join(",")},success:function(a){a.isSuccess&&f.userGrid.loadData(f.catalogId)}})}})})}),$("#addMenu").click(function(){var a=liger.get("catalogGrid"),b=a.getData(),c=common.getTopWindowDom();c.list_menu_storage=[],b&&$.each(b,function(a,b){var d={Id:b.Id,Name:b.Name};c.list_menu_storage.push(d)}),seajs.use("{dir}/BaseList/tools.js",function(a){a.menu({height:500,width:540,callback:function(a){var b=[];a&&$.each(a,function(a,c){b.push(c.id)});var c=new Request("/menu/addMenuAcc");c.post({data:{catalogId:f.catalogId,ids:b.join(",")},success:function(a){a.isSuccess&&f.grid.loadData(f.catalogId)}})}})})}),$(".btn-search").click(function(){f.userGrid.search(f.catalogId)})}},g={init:function(){var a=new Request("/dict/getItemList");a.post({isTip:!1,async:!0,data:{catalogCode:f.catalogCode},success:function(a){g.buildTree(a)}})},buildTree:function(a){var b=[];$.each(a.result,function(a,c){var d={};d.text=c.name,d.Id=c.id,b.push(d)});var c=$("#tree").ligerTree({nodeWidth:180,needCancel:!1,checkbox:!1,data:[{text:"权限分类",children:b}],onBeforeSelect:function(a){var b=a.data.Id;return!!b},onSelect:function(a){var b=a.data.Id;f.catalogId=b,f.grid.loadData(b),f.userGrid.loadData(b)},onExpand:function(a){}});c.selectNode($("[treedataindex='1']")[0])},refresh:function(){e.clear(),g.init()}};b.init=f.init});